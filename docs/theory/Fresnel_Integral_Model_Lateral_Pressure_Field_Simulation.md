# **Fresnel Integral-Based Simulation of Lateral Pressure Fields from a 1-D Piston Element**

## 1. Introduction

This simulation models the lateral pressure field generated by a 1-D rectangular piston source using the Fresnel integral formulation. It is based on the **paraxial approximation** and the **Fresnel integral model**, as discussed in Lester W. Schmerr Jr.'s *Fundamentals of Ultrasonic Phased Arrays*, particularly Sections **3.1**, **C.1**, and **C.5**.

The Fresnel approximation allows a simplified and efficient calculation of the pressure field under the assumption that the axial distance is much larger than the lateral dimension of the transducer, leading to a quasi-paraxial wavefront. This model is useful for capturing the near-field to far-field transition of beam profiles in the lateral plane.

## 2. Theoretical Background

The pressure field is computed using the Fresnel integral of the form:

$$
p(x, z) = \sqrt{\frac{1}{2j}} e^{j k b z / b} \left[ F\left(\sqrt{\frac{k b}{\pi z}}(\frac{x}{b}+1)\right) - F\left(\sqrt{\frac{k b}{\pi z}}(\frac{x}{b}-1)\right) \right]
$$

Where:

- $b$: Half-length of the element (mm)
- $f$: Frequency (MHz)
- $c$: Wave speed in the fluid (m/s)
- $k = \frac{2 \pi f \cdot 10^6}{c}$: Wavenumber (1/mm)
- $x$: Lateral position(s) (mm)
- $z$: Axial depth (mm)
- $F(u)$: Fresnel integral expression, as used in the Fresnel integral beam model

This implementation relies on the numerical evaluation of the Fresnel integral using the cosine and sine integrals defined in **Abramowitz and Stegun, Handbook of Mathematical Functions, pp. 301–302**.

## 3. Implementation Details

The CLI interface for this simulation is `fresnel_2D_interface.py`. The simulation computes the complex pressure field over a lateral profile at a fixed axial depth. The key parameters and default values are:

```sh
$ python ../../src/interface/fresnel_2D_interface.py --help
```

```
--b B                Half-length of the element (mm). Default: 6.0
--f F                Frequency (MHz). Default: 5.0
--c C                Wave speed (m/s). Default: 1500.0
--z Z                z-coordinate (mm) at which pressure is computed. Default: 60.0
--x X                x-coordinates (mm). e.g., "-10,10,200"
--outfile OUTFILE    Output file to save the pressure matrix. Default: pressure_output.txt
--plotfile PLOTFILE  If provided, the plot will be saved to this file.
```

## 4. Numerical Parameters and Spatial Resolution

- **Wavelength**: $\( \lambda = \frac{c}{f} = \frac{1500}{5 \times 10^6} = 0.3~\text{mm} \)$
- **Spatial Resolution**: $\( \lambda / 20 = 0.015~\text{mm} \)$

The lateral grid spacing was chosen accordingly:

```sh
x = "-10,10,1401"  # ~0.015 mm spacing
```

## 5. Simulation Results and CLI Commands

### **At depth z = 60 mm (Near Field)**

```sh
python ../../src/interface/fresnel_2D_interface.py --b 6 --f 5 --c 1500 --z 60.0 --x="-10,10,1401"
```

![Lateral Pressure Field z=60](../../examples/figures/Lateral_pressure_field_Fresnel_integral_z60.png)

### **At depth z = 120 mm (Transition Region)**

```sh
python ../../src/interface/fresnel_2D_interface.py --b 6 --f 5 --c 1500 --z 120 --x="-10,10,1401"
```

![Lateral Pressure Field z=120](../../examples/figures/Lateral_pressure_field_Fresnel_integral_z120.png)

### **At depth z = 180 mm (Far Field)**

```sh
python ../../src/interface/fresnel_2D_interface.py --b 6 --f 5 --c 1500 --z 180 --x="-10,10,1401"
```

![Lateral Pressure Field z=180](../../examples/figures/Lateral_pressure_field_Fresnel_integral_z180.png)

## 6. Interpretation of Near and Far Field Behavior

From Section **3.1** of Schmerr (2015), the near-field length can be roughly estimated by:

$$
N_f \approx \frac{b^2}{\lambda} = \frac{6^2}{0.3} = 120~\text{mm}
$$

Thus:

- **z = 60 mm**: Clear interference fringes, strong side lobes (near field)
- **z = 120 mm**: Central lobe begins to dominate, side lobes diminish (transition region)
- **z = 180 mm**: Central beam becomes Gaussian-like (far field)

## 7. Conclusion

The Fresnel integral model provides an efficient and accurate method for computing the lateral pressure distribution of a 1-D piston source in a fluid medium. This model captures the essential features of the beam profile including near-field diffraction effects and far-field focusing, validated against the paraxial approximation.

## References

- Schmerr, L. W. (2015). *Fundamentals of Ultrasonic Phased Arrays*. Springer International Publishing.
- Abramowitz, M., & Stegun, I. A. (1965). *Handbook of Mathematical Functions*. Dover Publications. pp. 301–302
